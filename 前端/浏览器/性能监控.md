# 基础

### DOMContentLoaded

chrome Network可以查看到该事件的执行时间，当文档中没有脚本时，浏览器解析完文档便能触发 DOMContentLoaded 事件；如果文档中包含脚本，则脚本会阻塞文档的解析，而脚本需要等 CSSOM 构建完成才能执行。在任何情况下，DOMContentLoaded 的触发不需要等待图片等其他资源加载完成。 

DOMContentLoaded 只有在 defer 脚本执行结束后才会被触发。HTML 文档解析不受影响，等 DOM 构建完成之后 defer 脚本执行，但脚本执行之前需要等待 CSSOM 构建完成。在 DOM、CSSOM 构建完毕，defer 脚本执行完成之后，DOMContentLoaded 事件触发。 

如果 script 标签中包含 async，则 HTML 文档构建不受影响，解析完毕后，DOMContentLoaded 触发，而不需要等待 async 脚本执行、样式表加载等等。 



### 异步脚本

 HTML5 中定义了两个定义异步脚本的方法：defer 和 async。 

执行过程示意图，绿色为htm parsing，灰色html parsing paused，蓝色脚本小子啊，红色脚本执行

#### 同步脚本

 ![img](https://pic1.zhimg.com/80/v2-13a528b83cb056030b6f16baa3c11a08_720w.png) 

#### defer脚本

 ![img](https://pic1.zhimg.com/80/v2-691db6cc805e6f8b2d17b5f16a6a3a0c_720w.png) 

当 HTML 文档被解析时如果遇见 defer 脚本，则在后台加载脚本，文档解析过程不中断，而等文档解析结束之后，defer 脚本执行。另外，defer 脚本的执行顺序与定义时的位置有关。 

#### async 脚本 

![img](https://pic4.zhimg.com/80/v2-220900e370b8243f44ee92620eba80c3_720w.png) 

当 HTML 文档被解析时如果遇见 async 脚本，则在后台加载脚本，文档解析过程不中断。脚本加载完成后，文档停止解析，脚本执行，执行结束后文档继续解析。过程如下图： 



# Performance接口

 https://segmentfault.com/a/1190000014479800 