参考文档：

https://developer.aliyun.com/article/715922





微前端核心价值：

- **技术栈无关**：主框架不限制接入应用的技术栈，子应用具备完全自主权
- **独立开发、独立部署**：子应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新
- **独立运行时**：每个子应用之间状态隔离，运行时状态不共享



| App Entry  | 优点                                                         | 缺点                                                         |
| ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| HTML Entry | 1. 子应用开发、发布完全独立<br />2. 子应用具备与独立应用开发时一致的开发体验 | 1. 多一次请求，子应用资源解析消耗转移到运行时<br />2. 主子应用不处于同一个构建环境，无法利用 bundler 的一些构建期的优化能力，如公共依赖抽取等 |
| JS Entry   | 主子应用使用同一个 bundler，可以方便做构建时优化             | 1. 子应用的发布需要主应用的重新打包<br />2. 主应用需为每个子应用预留一个容器节点，且该节点id需与子应用的容器id保持一致<br />3. 子应用的各类资源需要一起打成一个bundle，资源加载效率变低 |



> 当前我们微前端的一些问题：
>
> 1. 不统一技术栈，组件会写两套。跨应用弹窗通信问题。
> 2. 公共样式隔离，ant design / ant design vue











# 应用隔离

## 样式隔离

**Shadow DOM?**

1. 浏览器兼容性问题

2. 由于子应用的样式作用域仅在 shadow 元素下，那么一旦子应用中出现运行时越界跑到外面构建 DOM 的场景，必定会导致构建出来的 DOM 无法应用子应用的样式的情况。如 antd 的 Modal。

**CSS Module?BEM?**

每个应用特点的css前缀，或直接基于 css module

三方库在写入了大量的全局样式的同时又不支持定制化前缀？比如 a 应用引入了 antd 2.x，而b 应用引入了 antd 3.x，两个版本的 antd 都写入了全局的 .menu class ，但又彼此不兼容怎么办？

**Dynamic Stylesheet !**

解决方案其实很简单，我们只需要在应用切出/卸载后，同时卸载掉其样式表即可，原理是浏览器会对所有的样式表的插入、移除做整个 CSSOM 的重构，从而达到 插入、卸载 样式的目的。这样即能保证，在一个时间点里，只有一个应用的样式表是生效的。

上文提到的 HTML Entry 方案则天生具备样式隔离的特性，因为应用卸载后会直接移除去 HTML 结构，从而自动移除了其样式表。

> HC: 如果多个应用共存怎么版？



## JS隔离

如何实现？JS沙箱









